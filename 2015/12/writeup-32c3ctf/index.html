<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><title>Writeup: 32c3ctf - /home/cubarco</title><meta property="og:title" content="Writeup: 32c3ctf - /home/cubarco"><link href=https://cubl.in/favicon.ico rel=icon type=image/x-icon><meta name=description content="Hack, CTF, Writeup, Exploitation, PWN, MISC"><link rel=stylesheet href=/css/main.min.3bcbe33ae5c46485bcebc6352fc91232f950eb735ccac53f81bd19d79251ba9c.css media=all></head><body><div class=wrapper><header class=header><nav class=nav><a href=/ class=nav-logo><img src=/images/logo-min.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/>Index</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li><li><a href=/links/>Links</a></li><li><a href=https://github.com/cubarco/cubarco.github.io>GitHub</a></li></ul></nav></header><main class=content role=main><article class=article><h1 class=article-title>Writeup: 32c3ctf</h1><span class=article-date>2015-12-30</span>
<a class=article-tag href=/tags/hack>Hack</a>
<a class=article-tag href=/tags/ctf>CTF</a>
<a class=article-tag href=/tags/writeup>Writeup</a>
<a class=article-tag href=/tags/exploitation>Exploitation</a>
<a class=article-tag href=/tags/pwn>PWN</a>
<a class=article-tag href=/tags/misc>MISC</a><div class=article-content><h2 id=forth>forth</h2><p>forth ç›´æ¥èƒ½è·‘system<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>ã€‚</p><div class=highlight><pre class=chroma><code class=language-plain data-lang=plain>S&#34; sh&#34; system
</code></pre></div><h2 id=gurke>gurke</h2><p>pickle åœ¨ unpickle çš„æ—¶å€™ä¼šæ‰§è¡Œå¯¹è±¡çš„ <code>__reduce__</code> æ–¹æ³•<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>ã€‚ç”¨ eval æŠŠ <code>__main__.flag.flag</code> æ‰“è¿› stderr å°±è¡Œäº†ã€‚</p><code class=gist data-gist-id=cubarco/e46eb03e1cd06046d130><p>Gist: <a href=https://gist.github.com/cubarco/e46eb03e1cd06046d130>cubarco/e46eb03e1cd06046d130</a></p></code><h2 id=teufel>teufel</h2><p>è¿™é¢˜çš„ bin ä¸å¤§ï¼Œé‡Œé¢çš„ gadgets å¾ˆå°‘ï¼Œä½†æ˜¯ç»™äº† libc. æ€è·¯å°±æ˜¯å…ˆ leak å‡ºä¿å­˜åœ¨æ ˆä¸­çš„ rbp, ç„¶å offset åˆ° systemã€‚</p><p>è¿™ä¸ª offset è¦å…ˆåœ¨æœ¬æœºç¡®å®šåä¸‰ä½(16 è¿›åˆ¶), ç„¶åè·‘ä¸ªè„šæœ¬ï¼Œç”¨ 0x1000 çš„æ­¥é•¿å»çˆ†ç ´æœåŠ¡å™¨ä¸Šçš„ offset. æˆ‘çš„åŠæ³•æ˜¯å…ˆæ‰¾<code>__stack_chk_fail</code>, åŸå› æ˜¯è¿™ä¸ªå‡½æ•°ä¸éœ€è¦å‚æ•°å°±èƒ½è¾“å‡ºã€‚</p><h3 id=offsetpy>offset.py</h3><code class=gist data-gist-id=cubarco/569fd814a29d8ef988e1 data-gist-file=32c3ctf-teufel-offset.py><p>Gist: <a href=https://gist.github.com/cubarco/569fd814a29d8ef988e1>cubarco/569fd814a29d8ef988e1</a></p></code><h3 id=exppy>exp.py</h3><code class=gist data-gist-id=cubarco/569fd814a29d8ef988e1 data-gist-file=32c3ctf-teufel-exp.py><p>Gist: <a href=https://gist.github.com/cubarco/569fd814a29d8ef988e1>cubarco/569fd814a29d8ef988e1</a></p></code><h2 id=åæ§½><del>åæ§½</del></h2><p>~~readme çš„ flag å±…ç„¶æ˜¯æ–‡ä»¶å&mldr; ~~ä¸è¿‡<code>LIBC_FATAL_STDERR_</code>è¿™ä¸ªç¯å¢ƒå˜é‡ç¡®å®æ˜¯ä»¥å‰æ²¡è§è¿‡çš„ã€‚</p><p><strong>update 2016-01-24:</strong> å…³äº readme è¿™é“é¢˜ï¼Œä¹‹å‰ä»¥ä¸º flag æ˜¯æ–‡ä»¶åï¼Œåš ZCTF çš„ guess æ—¶<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>ï¼Œå›æ¥çœ‹æ‰å‘ç°åŸæ¥æ˜¯æŠŠ<code>argv[1]</code>æ”¹æ‰äº†ï¼Œè›®æœ‰æ„æ€ã€‚</p><p>@rickyz çš„ sandbox è§£æ³•<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>è›®æœ‰æ„æ€ï¼Œå±…ç„¶æƒ³åˆ°äº‰æŠ¢ä¿®æ”¹ç³»ç»Ÿè°ƒç”¨å‚æ•°ã€‚ç›´æ¥æ”¹<code>/proc/self/mem</code>æ¥æ”¹å˜ç¨‹åºæµä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡è§ã€‚</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=http://rosettacode.org/wiki/Execute_a_system_command#Forth>Execute a system command#forth</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=https://docs.python.org/2/library/pickle.html#object.__reduce__>Pickling and unpickling extension types</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p><a href=https://cubl.in/blog/2016/01/writeup-zctf/>Writeup: ZCTF</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p><a href=https://rzhou.org/~ricky/32c3/sandbox/>Index of /~ricky/32c3/sandbox/</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><script src=https://utteranc.es/client.js repo=cubarco/cubarco.github.io issue-term=pathname label="Comments ğŸ’¬" theme=boxy-light crossorigin=anonymous async defer></script></main><footer class=footer><ul class=footer-links><li><a href=/index.xml type=application/rss+xml target=_blank>RSS feed</a></li><li><a href=https://gohugo.io/ class=footer-links-kudos target=_blank rel="noopener norefferrer">Made with <img src=/images/hugo-logo.png alt="Img link to Hugo website" width=22 height=22></a></li><li><a>Â© 2014 - 2015</a></li></ul></footer></div><script async src=https://cdn.jsdelivr.net/gh/cubarco/cubarco.github.io@gh-pages/js/async.min.f0ee05a5180b84c9031dc6048a165e3238369671eaac5df72f9fc961a2bb03f78685ba489261432234bcbad8b66c86ffa90cffd19f60c4b28ef06e677fc9763f.js onload=window.GistEmbed.init()></script><script async defer src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js></script><script>window.ga_tid="UA-54867602-1",window.ga_api="https://cubl.in/ga-proxy/"</script><script src=https://cdn.jsdelivr.net/npm/cfga@1.0.3 async defer></script><script async defer data-website-id=e9fdcc32-0bfa-4de5-beb0-3bbf1e4638ab src=https://umami.2oo.in/umami.js></script></body></html>