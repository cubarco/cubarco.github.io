<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><title>Writeup-Pwnable: unexploitable - /home/cubl</title><meta property="og:title" content="Writeup-Pwnable: unexploitable - /home/cubl"><link href=/favicon.ico rel=icon type=image/x-icon><link rel=stylesheet href=/css/fonts.css media=all><link rel=stylesheet href=/css/main.css media=all><script src=/js/source-code-pro.js></script></head><body><div class=wrapper><header class=header><nav class=nav><a href=/ class=nav-logo><img src=/images/logo-min.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li><li><a href=https://github.com/cubarco/cubarco.github.io>GitHub</a></li></ul></nav></header><main class=content role=main><article class=article><h1 class=article-title>Writeup-Pwnable: unexploitable</h1><span class=article-date>2015-12-23</span>
<a class=article-tag href=/tags/hack>Hack</a>
<a class=article-tag href=/tags/ctf>CTF</a>
<a class=article-tag href=/tags/writeup>Writeup</a>
<a class=article-tag href=/tags/exploitation>Exploitation</a>
<a class=article-tag href=/tags/rop>ROP</a>
<a class=article-tag href=/tags/srop>SROP</a><div class=article-content><h2 id=rop>ROP</h2><p>这题主要就是在 0x400560 藏了一个<code>0F 0A</code>的 opcode, 对应的 x64 指令是<code>syscall</code>, 找到这个就好办了。</p><p>然后构造 ROP, 一开始找不到控制 rax 的 gadgets, 搜了一下发现可以利用<code>read()</code>的返回值。具体的构造就是时间问题了，x64 的 ROP 可以看这篇文章<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。</p><h3 id=exp-roppy>exp-rop.py</h3><p>{% gist cubarco/23b04edc7e79b1c71547 pwnable-hackerssecret-unexploitable-rop.py %}</p><h2 id=srop>SROP</h2><p>结果 flag 里提到 SROP 的解法，我就又写了个 SROP. 简单的 SROP 介绍可以看这篇文章<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>。</p><h3 id=exp-sroppy>exp-srop.py</h3><p>{% gist cubarco/23b04edc7e79b1c71547 pwnable-hackerssecret-unexploitable-srop.py %}</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=http://drops.wooyun.org/papers/7551>一步一步学ROP之linux_x64篇</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=http://www.freebuf.com/articles/network/87447.html>Sigreturn Oriented Programming (SROP) Attack攻击原理</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article></main><footer class=footer><ul class=footer-links><li><a href=/index.xml type=application/rss+xml target=_blank>RSS feed</a></li><li><a href=https://gohugo.io/ class=footer-links-kudos target=_blank>Made with <img src=/images/hugo-logo.png alt="Img link to Hugo website" width=22 height=22></a></li><li><a>© 2014 - 2015</a></li></ul></footer></div></body></html>