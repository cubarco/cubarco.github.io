<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><title>é€šè¿‡DNSéš§é“ç»•è¿‡portalè®¤è¯ - /home/cubl</title><meta property="og:title" content="é€šè¿‡DNSéš§é“ç»•è¿‡portalè®¤è¯ - /home/cubl"><link href=https://cubl.in/favicon.ico rel=icon type=image/x-icon><meta name=description content="Amazing, Android, HustWireless, iodine, Linux, Portal"><link rel=stylesheet href=/css/main.min.39d87073ffff84c35a9b5d21e8b94ef0643a51af7a909c6f3d506433db4442a1.css media=all></head><body><div class=wrapper><header class=header><nav class=nav><a href=/ class=nav-logo><img src=/images/logo-min.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/>Index</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li><li><a href=https://github.com/cubarco/cubarco.github.io>GitHub</a></li></ul></nav></header><main class=content role=main><article class=article><h1 class=article-title>é€šè¿‡DNSéš§é“ç»•è¿‡portalè®¤è¯</h1><span class=article-date>2014-02-11</span>
<a class=article-tag href=/tags/amazing>Amazing</a>
<a class=article-tag href=/tags/android>Android</a>
<a class=article-tag href=/tags/hustwireless>HustWireless</a>
<a class=article-tag href=/tags/iodine>iodine</a>
<a class=article-tag href=/tags/linux>Linux</a>
<a class=article-tag href=/tags/portal>Portal</a><div class=article-content><blockquote><p>Â  Â  Â  Â  Portalåœ¨è‹±è¯­ä¸­æ˜¯å…¥å£çš„æ„æ€ã€‚Portalè®¤è¯é€šå¸¸ä¹Ÿç§°ä¸ºWebè®¤è¯ï¼Œä¸€èˆ¬å°†Portalè®¤è¯ç½‘ç«™ç§°ä¸ºé—¨æˆ·ç½‘ç«™ã€‚æœªè®¤è¯ç”¨æˆ·ä¸Šç½‘æ—¶ï¼Œè®¾å¤‡å¼ºåˆ¶ç”¨æˆ·ç™»å½•åˆ°ç‰¹å®šç«™ç‚¹ï¼Œç”¨æˆ·å¯ä»¥å…è´¹è®¿é—®å…¶ä¸­çš„æœåŠ¡ã€‚å½“ç”¨æˆ·éœ€è¦ä½¿ç”¨äº’è”ç½‘ä¸­çš„å…¶å®ƒä¿¡æ¯æ—¶ï¼Œå¿…é¡»åœ¨é—¨æˆ·ç½‘ç«™è¿›è¡Œè®¤è¯ï¼Œåªæœ‰è®¤è¯é€šè¿‡åæ‰å¯ä»¥ä½¿ç”¨äº’è”ç½‘èµ„æºã€‚ç”¨æˆ·å¯ä»¥ä¸»åŠ¨è®¿é—®å·²çŸ¥çš„Portalè®¤è¯ç½‘ç«™ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œè®¤è¯ï¼Œè¿™ç§å¼€å§‹Portalè®¤è¯çš„æ–¹å¼ç§°ä½œä¸»åŠ¨è®¤è¯ã€‚åä¹‹ï¼Œå¦‚æœç”¨æˆ·è¯•å›¾é€šè¿‡HTTPè®¿é—®å…¶ä»–å¤–ç½‘ï¼Œå°†è¢«å¼ºåˆ¶è®¿é—®Portalè®¤è¯ç½‘ç«™ï¼Œä»è€Œå¼€å§‹Portalè®¤è¯è¿‡ç¨‹ï¼Œè¿™ç§æ–¹å¼ç§°ä½œå¼ºåˆ¶è®¤è¯ã€‚</p></blockquote><p>æ¯”å¦‚è¯´ï¼šåæŸç§‘æ ¡å›­ç½‘(æ— çº¿ç«¯), Chinanet, CMCC, China-Unicom</p><p>ï¼ˆåæŸç§‘æ ¡å›­ç½‘å‡çº§åï¼ŒDNSéš§é“è¢«ä¸€å®šç¨‹åº¦é™ç”¨ï¼Œå¤„äºåŠæ®‹çŠ¶æ€ã€‚åŸºæœ¬æ— æ³•ä½¿ç”¨ã€‚ï¼‰</p><p>portalè®¤è¯ä¸åŒäºpppoeï¼Œå®ƒå·²ç»é€šè¿‡DHCPå¯¹Clientåˆ†å‘IPï¼Œä½†æ˜¯åœ¨å®Œæˆè®¤è¯å‰ä¼šå¼ºåˆ¶é‡å®šå‘urlåˆ°protalè®¤è¯ç•Œé¢ï¼Œåªæœ‰ç™»å½•åæ‰èƒ½é¡ºåˆ©çš„è®¿é—®ç½‘ç»œã€‚ä¸è¿‡portalè®¤è¯å¹¶æ²¡æœ‰é˜»æ­¢DNSæŸ¥è¯¢çš„è¯·æ±‚ï¼Œé€šè¿‡ä¸€å®šæ‰‹æ®µå¯ä»¥ç»•è¿‡portalè®¤è¯ï¼Œç›´æ¥è®¿é—®internetã€‚æˆ‘ä»¬éœ€è¦çš„è½¯ä»¶å°±æ˜¯iodine</p><blockquote><p>iodine lets you tunnel IPv4 data through a DNS server. This can be usable in different situations where internet access is firewalled, but DNS queries are allowed.</p></blockquote><blockquote></blockquote><p>ä¸ºäº†æ„å»ºDNSéš§é“ï¼Œä¸€å°æœåŠ¡å™¨å’Œä¸€ä¸ªåŸŸåæ˜¯å¿…é¡»çš„ã€‚ä½ éœ€è¦åœ¨DNSæœåŠ¡å™¨æ·»åŠ ä¸¤æ¡è®°å½•ï¼Œè¿™ä¸€æ­¥å°¤ä¸ºé‡è¦ã€‚ä¸€æ¡æ˜¯NSè®°å½•ï¼Œa.yourdomain.comï¼Œçºªå½•å€¼æ˜¯â€b.yourdomain.com.â€(ä¸è¦å¿˜äº†æœ€åä¸€ä¸ªdot)ï¼Œå¦ä¸€æ¡æ˜¯Aè®°å½•ï¼Œb.yourdomain.comï¼Œè®°å½•å€¼æ˜¯serverç«¯çš„å…¬ç½‘IPï¼ˆexample: 123.456.789.123ï¼‰ã€‚è®¾ç½®å¥½äº†ä»¥åå¯ä»¥åœ¨<a href=http://code.kryo.se/iodine/check-it/>http://code.kryo.se/iodine/check-it/</a>è¾“å…¥a.yourdomain.comæµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸã€‚</p><p>ä½¿ç”¨iodineå¿…é¡»è¦ä¿è¯serverç«¯å’Œclientç«¯çš„iodineç‰ˆæœ¬ç›¸åŒï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯ç¼–è¯‘å®‰è£…ï¼Œæºç æ˜¯gitç‰ˆæœ¬ã€‚</p><h2 id=serverç«¯>Serverç«¯</h2><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>git clone https://github.com/yarrick/iodine.git
<span class=nb>cd</span> iodine
make
sudo make install
</code></pre></div><p>ç¼–è¯‘å®‰è£…å®Œæ¯•ï¼Œåœ¨serverç«¯ä½¿ç”¨çš„æ˜¯iodinedã€‚</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>Usage: iodined <span class=o>[</span>-v<span class=o>]</span> <span class=o>[</span>-h<span class=o>]</span> <span class=o>[</span>-c<span class=o>]</span> <span class=o>[</span>-s<span class=o>]</span> <span class=o>[</span>-f<span class=o>]</span> <span class=o>[</span>-D<span class=o>]</span> <span class=o>[</span>-u user<span class=o>]</span> <span class=o>[</span>-t chrootdir<span class=o>]</span> <span class=o>[</span>-d device<span class=o>]</span> <span class=o>[</span>-m mtu<span class=o>]</span> <span class=o>[</span>-z context<span class=o>]</span> <span class=o>[</span>-l ip address to listen on<span class=o>]</span> <span class=o>[</span>-p port<span class=o>]</span> <span class=o>[</span>-n external ip<span class=o>]</span> <span class=o>[</span>-b dnsport<span class=o>]</span> <span class=o>[</span>-P password<span class=o>]</span> <span class=o>[</span>-F pidfile<span class=o>]</span> tunnel_ip<span class=o>[</span>/netmask<span class=o>]</span> topdomain
</code></pre></div><p>ä¸€èˆ¬åªéœ€è¦ä¸¤ä¸ªå¯é€‰å‚æ•°cå’ŒPï¼Œæµ‹è¯•é˜¶æ®µå¯ä»¥ä½¿ç”¨fã€‚</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>-c to disable check of client IP/port on each request
-P password used <span class=k>for</span> authentication <span class=o>(</span>max <span class=m>32</span> chars will be used<span class=o>)</span>
-f to keep running in foreground

tunnel_ip is the IP number of the <span class=nb>local</span> tunnel interface.
<span class=c1>#ä»£ç æ‰§è¡Œåï¼ŒæœåŠ¡å™¨ä¼šå¤šå‡ºä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œipä¸ºæ­¤å‚æ•°è®¾å®šå€¼</span>
netmask sets the size of the tunnel network.
topdomain is the FQDN that is delegated to this server.
<span class=c1>#ä¸Šæ–‡æåˆ°çš„a.yourdomain.com</span>
</code></pre></div><p>æ¥ä¸‹æ¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo iodined -c -f -P yourpassword 192.168.99.1 a.yourdomain.com
</code></pre></div><p>ä¼šçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼Œè¡¨ç¤ºserverç«¯è®¾ç½®å®Œæ¯•ã€‚</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>Opened dns0
Setting IP of dns0 to 192.168.99.1
Setting MTU of dns0 to <span class=m>1130</span>
Opened IPv4 UDP socket
Listening to dns <span class=k>for</span> domain a.yourdomain.com
</code></pre></div><h2 id=clientç«¯linux>Â Clientç«¯ï¼ˆlinuxï¼‰</h2><p>iodineçš„å®‰è£…åŒServerç«¯ï¼Œä¸å†èµ˜è¿°ã€‚</p><p>éœ€è¦è¿æ¥serveræ—¶åªéœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>iodine a.yourdomain.com
</code></pre></div><p>æ¥ä¸‹æ¥äº¤äº’å¼è¾“å…¥åˆšæ‰åœ¨serverç«¯è®¾ç½®çš„å¯†ç ï¼Œä½ ä¼šçœ‹åˆ°ä»¥ä¸‹è¾“å‡º</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>Opened dns0
Opened IPv4 UDP socket
Sending DNS queries <span class=k>for</span> a.yourdomain.com to 8.8.8.8  
<span class=c1>#8.8.8.8æ˜¯ä½ clientç«¯çš„ä¸»DNS</span>
Autodetecting DNS query <span class=nb>type</span> <span class=o>(</span>use -T to override<span class=o>)</span>.
Using DNS <span class=nb>type</span> NULL queries
Version ok, both using protocol v 0x00000502. You are user <span class=c1>#0</span>
Setting IP of dns0 to 192.168.99.2
Setting MTU of dns0 to <span class=m>1130</span>
Server tunnel IP is 192.168.99.1
Testing raw UDP data to the server <span class=o>(</span>skip with -r<span class=o>)</span>
Server is at 123.456.789.123, trying raw login: OK
Sending raw traffic directly to 123.456.789.123
Connection setup complete, transmitting data.
Detaching from terminal...
</code></pre></div><p>è¿™æ ·iodineå°±åœ¨clientç«¯å¼€å¯äº†ä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼ŒIPä¸º192.168.99.2ï¼Œä¸åˆšæ‰åœ¨serverç«¯è®¾ç½®çš„192.168.99.1å¤„äºåŒä¸€ä¸ªç½‘æ®µï¼Œè‡³æ­¤ä¾¿å¯ä»¥ç”¨192.168.99.1è¿™ä¸ªæ–°çš„IPä¸serveræ®µé€šä¿¡äº†ï¼Œç„¶åå¯ä»¥é‡‡ç”¨socksä»£ç†ã€httpä»£ç†ä¹‹ç±»çš„æ–¹æ³•è¿é€šinternetã€‚pingä¸€ä¸‹è¯•è¯•å§ã€‚</p><h2 id=clientç«¯android>Clientç«¯ï¼ˆAndroidï¼‰</h2><p>å¯ä»¥åœ¨pcä¸Šä¸‹è½½ndkï¼ˆndkçš„é…ç½®è¯·è‡ªè¡Œæ±‚åŠ©æœç´¢å¼•æ“XDï¼‰ï¼Œç„¶ååœ¨androidç¯å¢ƒç¼–è¯‘å®‰è£…ï¼Œæ–¹æ³•å…¶å®éƒ½å†™åœ¨äº†READMEé‡Œé¢ï¼Œæˆ‘è½¬è¿°ä¸€å‘å¥½äº†ã€‚</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>$ <span class=nb>cd</span> ./iodine/src
$ make base64u.h base64u.c
$ ndk-build <span class=nv>NDK_PROJECT_PATH</span><span class=o>=</span>. <span class=nv>APP_BUILD_SCRIPT</span><span class=o>=</span>Android.mk
</code></pre></div><p>ç„¶åæ–°é²œå‡ºç‚‰çš„androidç«¯iodineå°±å‡ºç°åœ¨äº†iodine/src/libs/armeabi/iodineï¼Œç”¨adbæ‹‰åˆ°æ‰‹æœºé‡Œé¢å°±è¡Œäº†ï¼ˆé™„ä»¶æä¾›äº†å·²ç¼–è¯‘çš„iodineæ–‡ä»¶ï¼‰</p><p>ä½†æ˜¯åœ¨androidç«¯è¿è¡Œiodineè¿˜éœ€è¦å¿…ä¸å¯å°‘çš„tun.koï¼Œå¯ä»¥ç›´æ¥åœ¨åº”ç”¨å¸‚åœºæœâ€œtun.koâ€ï¼Œå¾ˆå¤šappèƒ½æ–¹ä¾¿åœ°å®‰è£…tun.koã€‚</p><p>æ¥ä¸‹æ¥çš„ä½¿ç”¨å°±å’Œåœ¨linuxä¸‹ä¸€æ ·äº†ã€‚</p><h2 id=clientç«¯windows>Clientç«¯ï¼ˆwindowsï¼‰</h2><p><del>å‘µå‘µÂ </del></p><h2 id=é™„ä»¶>é™„ä»¶</h2><ul><li>tun.ko installer : Google Play</li><li>iodine for android (20140211 ) ï¼šÂ Google DocsÂ  Â  Â ç™¾åº¦ç½‘ç›˜</li><li><del>å¦‚æœä¸å«Œå¼ƒï¼Œå¯ä»¥å°†è¿™ä¸ªVPSæä¾›ç»™å„ä½æµ‹è¯•ä½¿ç”¨ã€‚</del>(53ç«¯å£ç§»ä½œä»–ç”¨ï¼Œå°±ä¸æä¾›æµ‹è¯•ä½¿ç”¨äº†ã€‚)</li></ul><h2 id=å‚è€ƒ>å‚è€ƒ</h2><ul><li>iodineä½œè€…çš„READMEï¼š<a href=https://github.com/yarrick/iodine>https://github.com/yarrick/iodine</a></li><li>ã€Šæœ‰DNSçš„åœ°æ–¹å°±èƒ½ä¸Šç½‘ã€‹â€”â€”è‡ªç”±çš„é£</li><li>ã€ŠPortalæŠ€æœ¯ä»‹ç»ã€‹â€”â€”H3C</li></ul></div></article><script src=https://utteranc.es/client.js repo=cubarco/cubarco.github.io issue-term=pathname label="Comments ğŸ’¬" theme=boxy-light crossorigin=anonymous async></script></main><footer class=footer><ul class=footer-links><li><a href=/index.xml type=application/rss+xml target=_blank>RSS feed</a></li><li><a href=https://gohugo.io/ class=footer-links-kudos target=_blank rel="noopener norefferrer">Made with <img src=/images/hugo-logo.png alt="Img link to Hugo website" width=22 height=22></a></li><li><a>Â© 2014 - 2014</a></li></ul></footer></div><script src=https://cdn.jsdelivr.net/gh/cubarco/cubarco.github.io@gh-pages/js/main.min.4f8f8d57bd4e088a41d6e3c416a7b1b7a009a40cdf08a064e67009327d2f750ad369fc07c6e43cfac03a8353cb05429a56004a0aed7a3243501ef6ac3cd5b1a0.js async></script><script>window.ga_tid="UA-54867602-1",window.ga_api="https://cubl.in/ga-proxy/"</script><script src=https://cdn.jsdelivr.net/npm/cfga@1.0.3 async></script><script async defer data-website-id=e9fdcc32-0bfa-4de5-beb0-3bbf1e4638ab src=https://umami.pwn.ooo/umami.js></script><script async defer src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js></script></body></html>