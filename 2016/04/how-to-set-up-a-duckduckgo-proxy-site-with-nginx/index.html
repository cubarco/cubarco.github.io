<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><title>如何用 Nginx 搭建简单的 DuckDuckGo 代理站 - /home/cubarco</title><meta property="og:title" content="如何用 Nginx 搭建简单的 DuckDuckGo 代理站 - /home/cubarco"><link href=https://cubl.in/favicon.ico rel=icon type=image/x-icon><meta name=description content="Linux, GFW, DuckDuckGo, Proxy"><link rel=stylesheet href=/css/main.min.3bcbe33ae5c46485bcebc6352fc91232f950eb735ccac53f81bd19d79251ba9c.css media=all></head><body><div class=wrapper><header class=header><nav class=nav><a href=/ class=nav-logo><img src=/images/logo-min.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/>Index</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li><li><a href=/links/>Links</a></li><li><a href=https://github.com/cubarco/cubarco.github.io>GitHub</a></li></ul></nav></header><main class=content role=main><article class=article><h1 class=article-title>如何用 Nginx 搭建简单的 DuckDuckGo 代理站</h1><span class=article-date>2016-04-09</span>
<a class=article-tag href=/tags/linux>Linux</a>
<a class=article-tag href=/tags/gfw>GFW</a>
<a class=article-tag href=/tags/duckduckgo>DuckDuckGo</a>
<a class=article-tag href=/tags/proxy>Proxy</a><div class=article-content><p>最近感觉手机的网络环境经常变，在寝室 v6， 出门 v4，有的时候会懒得开代理。所以就用 cloudflare+nginx 搞了个简单的 <a href=https://duckduckgo.com>DuckDuckGo</a> 代理站，方便随时掏出手机搜索。没有选择代理 Google 有几点原因，一个是 vps 连 Google 经常让输验证码，再就是 DuckDuckGo 不带 cookie 的搜索结果貌似比 Google 优(?)。</p><h2 id=nginx>Nginx</h2><p>nginx 的配置文件如下。<code>domain.com</code> 改成具体的域名，<code>/path/to/</code>要改成 duck.domain.com 的证书路径。<code>/etc/letsencrypt/live/images.duck.domain.com/</code>是 Let&rsquo;s encrypt 生成证书的默认目录，稍后会提到。</p><code class=gist data-gist-id=cubarco/08e99fbf316a435b7935727810e40458><p>Gist: <a href=https://gist.github.com/cubarco/08e99fbf316a435b7935727810e40458>cubarco/08e99fbf316a435b7935727810e40458</a></p></code><h2 id=cloudflare>Cloudflare</h2><p>duck.domain.com 可以用 Cloudflare 做 CDN，然后 crypto 策略选 Full(非strict) 的话在服务器上可以随便给 duck.domain.com 创建个证书用，具体参照<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。但是像 images.duck.domain.com 这种三级域名的话，Cloudflare 是没有给 SSL 证书的，所以只好自己在服务器上配，推荐用 Let&rsquo;s encrypt 签证书，方便快捷。</p><h2 id=lets-encrypt>Let&rsquo;s encrypt</h2><p>Let&rsquo;s encrypt 的使用细节我就不赘述了，可以看官方给的 Guide<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><p>这里需要的三个证书可以用如下命令生成：</p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>./letsencrypt-auto certonly --manual -d images.duck.domain.com <span class=se>\
</span><span class=se></span>    -d icons.duck.domain.com <span class=se>\
</span><span class=se></span>    -d ac.duck.domain.com
</code></pre></div><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://gist.github.com/jessedearing/2351836>Create self-signed SSL certificate for Nginx</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=https://letsencrypt.org/getting-started/>Getting Started @ Let&rsquo;s Encrypt</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><script src=https://utteranc.es/client.js repo=cubarco/cubarco.github.io issue-term=pathname label="Comments 💬" theme=boxy-light crossorigin=anonymous async defer></script></main><footer class=footer><ul class=footer-links><li><a href=/index.xml type=application/rss+xml target=_blank>RSS feed</a></li><li><a href=https://gohugo.io/ class=footer-links-kudos target=_blank rel="noopener norefferrer">Made with <img src=/images/hugo-logo.png alt="Img link to Hugo website" width=22 height=22></a></li><li><a>© 2014 - 2016</a></li></ul></footer></div><script async src=https://cdn.jsdelivr.net/gh/cubarco/cubarco.github.io@gh-pages/js/async.min.f0ee05a5180b84c9031dc6048a165e3238369671eaac5df72f9fc961a2bb03f78685ba489261432234bcbad8b66c86ffa90cffd19f60c4b28ef06e677fc9763f.js onload=window.GistEmbed.init()></script><script async defer src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js></script><script>window.ga_tid="UA-54867602-1",window.ga_api="https://cubl.in/ga-proxy/"</script><script src=https://cdn.jsdelivr.net/npm/cfga@1.0.3 async defer></script><script async defer data-website-id=e9fdcc32-0bfa-4de5-beb0-3bbf1e4638ab src=https://umami.pwn.ooo/umami.js></script></body></html>