<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><title>如何用 Nginx 搭建简单的 DuckDuckGo 代理站 - /home/cubl</title><meta property="og:title" content="如何用 Nginx 搭建简单的 DuckDuckGo 代理站 - /home/cubl"><link href=/favicon.ico rel=icon type=image/x-icon><link rel=stylesheet href=/css/main.min.9ae39f94818f4da457a6d1bcb86758258559067c36817f968ab59ae3c5c39b4bb6b793e3de3d4cc608ab8e1e4d178f67f70ad266ed0fadfae98939fab0d30b92.css integrity="sha512-muOflIGPTaRXptG8uGdYJYVZBnw2gX+WirWa48XDm0u2t5Pj3j1Mxgirjh5NF49n9wrSZu0PrfrpiTn6sNMLkg==" media=all></head><body><div class=wrapper><header class=header><nav class=nav><a href=/ class=nav-logo><img src=/images/logo-min.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li><li><a href=https://github.com/cubarco/cubarco.github.io>GitHub</a></li></ul></nav></header><main class=content role=main><article class=article><h1 class=article-title>如何用 Nginx 搭建简单的 DuckDuckGo 代理站</h1><span class=article-date>2016-04-09</span>
<a class=article-tag href=/tags/linux>Linux</a>
<a class=article-tag href=/tags/gfw>GFW</a>
<a class=article-tag href=/tags/duckduckgo>DuckDuckGo</a>
<a class=article-tag href=/tags/proxy>Proxy</a><div class=article-content><p>最近感觉手机的网络环境经常变，在寝室 v6， 出门 v4，有的时候会懒得开代理。所以就用 cloudflare+nginx 搞了个简单的 <a href=https://duckduckgo.com>DuckDuckGo</a> 代理站，方便随时掏出手机搜索。没有选择代理 Google 有几点原因，一个是 vps 连 Google 经常让输验证码，再就是 DuckDuckGo 不带 cookie 的搜索结果貌似比 Google 优(?)。</p><h2 id=nginx>Nginx</h2><p>nginx 的配置文件如下。<code>domain.com</code> 改成具体的域名，<code>/path/to/</code>要改成 duck.domain.com 的证书路径。<code>/etc/letsencrypt/live/images.duck.domain.com/</code>是 Let&rsquo;s encrypt 生成证书的默认目录，稍后会提到。</p><div class=gist data-gist=cubarco/08e99fbf316a435b7935727810e40458><p>Gist: <a href=https://gist.github.com/cubarco/08e99fbf316a435b7935727810e40458>cubarco/08e99fbf316a435b7935727810e40458</a></p></div><h2 id=cloudflare>Cloudflare</h2><p>duck.domain.com 可以用 Cloudflare 做 CDN，然后 crypto 策略选 Full(非strict) 的话在服务器上可以随便给 duck.domain.com 创建个证书用，具体参照<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。但是像 images.duck.domain.com 这种三级域名的话，Cloudflare 是没有给 SSL 证书的，所以只好自己在服务器上配，推荐用 Let&rsquo;s encrypt 签证书，方便快捷。</p><h2 id=lets-encrypt>Let&rsquo;s encrypt</h2><p>Let&rsquo;s encrypt 的使用细节我就不赘述了，可以看官方给的 Guide<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><p>这里需要的三个证书可以用如下命令生成：</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>./letsencrypt-auto certonly --manual -d images.duck.domain.com <span style=color:#d14>\
</span><span style=color:#d14></span>    -d icons.duck.domain.com <span style=color:#d14>\
</span><span style=color:#d14></span>    -d ac.duck.domain.com
</code></pre></td></tr></table></div></div><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://gist.github.com/jessedearing/2351836>Create self-signed SSL certificate for Nginx</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=https://letsencrypt.org/getting-started/>Getting Started @ Let&rsquo;s Encrypt</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><script src=https://utteranc.es/client.js repo=cubarco/cubarco.github.io issue-term=pathname theme=boxy-light crossorigin=anonymous async></script></main><footer class=footer><ul class=footer-links><li><a href=/index.xml type=application/rss+xml target=_blank>RSS feed</a></li><li><a href=https://gohugo.io/ class=footer-links-kudos target=_blank>Made with <img src=/images/hugo-logo.png alt="Img link to Hugo website" width=22 height=22></a></li><li><a>© 2014 - 2016</a></li></ul></footer></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js async></script><script src=/js/main.min.c0265b880e16484a6541ce80355a1ae627d6edcece7e9f5e5a47848c6776dae31c76328b55a8531b625aaf4315dcec7fdf695e3d044d3c19b918e21490e323e5.js integrity="sha512-wCZbiA4WSEplQc6ANVoa5ifW7c7Ofp9eWkeEjGd22uMcdjKLVahTG2Jar0MV3Ox/32lePQRNPBm5GOIUkOMj5Q==" async></script></body></html>