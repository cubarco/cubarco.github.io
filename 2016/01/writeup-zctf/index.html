<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><title>Writeup: ZCTF - /home/cubarco</title><meta property="og:title" content="Writeup: ZCTF - /home/cubarco"><link href=https://cubar.co/favicon.ico rel=icon type=image/x-icon><meta name=description content="Hack, CTF, Writeup, Exploitation, PWN"><link rel=stylesheet href=/css/main.min.3bcbe33ae5c46485bcebc6352fc91232f950eb735ccac53f81bd19d79251ba9c.css media=all></head><body><div class=wrapper><header class=header><nav class=nav><a href=/ class=nav-logo><img src=/images/logo-min.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/>Index</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li><li><a href=/links/>Links</a></li><li><a href=https://github.com/cubarco/cubarco.github.io>GitHub</a></li></ul></nav></header><main class=content role=main><article class=article><h1 class=article-title>Writeup: ZCTF</h1><span class=article-date>2016-01-24</span>
<a class=article-tag href=/tags/hack>Hack</a>
<a class=article-tag href=/tags/ctf>CTF</a>
<a class=article-tag href=/tags/writeup>Writeup</a>
<a class=article-tag href=/tags/exploitation>Exploitation</a>
<a class=article-tag href=/tags/pwn>PWN</a><div class=article-content><blockquote><p>2016 年第一篇 blog!</p></blockquote><p>这次只做出两道 pwn, 好忧伤&mldr;</p><h2 id=guess>guess</h2><p>在最近的 32c3ctf 中出现过一道类似的 readme<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. 就是把<code>argv[1]</code>改成目的字符串位置，可以在 libc 打出错误信息的时候，被当作文件名打印出来。</p><code class=gist data-gist-id=cubarco/cbbd4ab5462c2f0f287b><p>Gist: <a href=https://gist.github.com/cubarco/cbbd4ab5462c2f0f287b>cubarco/cbbd4ab5462c2f0f287b</a></p></code><h2 id=note1>note1</h2><p>这题的 note 是以链表形式储存的，堆溢出（edit 存在溢出漏洞）之后可以覆盖地址更改链表结构。我的 exp 思路就是先把一个 note 指向<code>setvbuf()</code>的 got, 然后用 show 把地址 leak 出来，这样可以 offset 到<code>system()</code>. 然后再将另一个 note 地址改到<code>strcmp()</code>的 got, 通过 edit 把内容改成<code>system()</code>的地址。最后调用<code>strcmp()</code>, title 填<code>/bin/sh</code>就可以了。</p><code class=gist data-gist-id=cubarco/30a44a61252f448964c4><p>Gist: <a href=https://gist.github.com/cubarco/30a44a61252f448964c4>cubarco/30a44a61252f448964c4</a></p></code><h2 id=note2><del>note2</del></h2><p>这题在赛时没找到漏洞，赛后看了 FlappyPig 的 Writeup<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, 只是简单的 fastbin, 感觉好可惜&mldr; 360 安全播报给的代码没缩进根本不能看，自己重新写了个。</p><code class=gist data-gist-id=cubarco/9752fbbe78a071b04b37><p>Gist: <a href=https://gist.github.com/cubarco/9752fbbe78a071b04b37>cubarco/9752fbbe78a071b04b37</a></p></code><h2 id=note3><del>note3</del></h2><p>这题同样是没有在赛时做出来，但是与 note2 相反，这题我是找到了两个可以利用的漏洞的(一个是 integer overflow, 另一个是可以增加第八个 note), 但是不知道如何利用。我在比赛的时候一直想着怎么 fastbin, 因为我觉得 unlink 这么古老的 exp 肯定已经不能用了&mldr; 没想到这题的环境刚好适合 unlink, 有点可惜。赛后看了 FlappyPig 的 Writeup<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, 自己重新写了个 exp, 也算是复习一下 unlink.</p><code class=gist data-gist-id=cubarco/ababdac123a4762c0180><p>Gist: <a href=https://gist.github.com/cubarco/ababdac123a4762c0180>cubarco/ababdac123a4762c0180</a></p></code><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://github.com/ctfs/write-ups-2015/tree/master/32c3-ctf-2015/pwn/readme-200>write-ups-2015/32c3-ctf-2015/pwn/readme-200/ @ GitHub</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=http://bobao.360.cn/ctf/detail/158.html>ZCTF Writeup @ 360 安全播报</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><script src=https://utteranc.es/client.js repo=cubarco/cubarco.github.io issue-term=pathname label="Comments 💬" theme=boxy-light crossorigin=anonymous async defer></script></main><footer class=footer><ul class=footer-links><li><a href=/index.xml type=application/rss+xml target=_blank>RSS feed</a></li><li><a href=https://gohugo.io/ class=footer-links-kudos target=_blank rel="noopener norefferrer">Made with <img src=/images/hugo-logo.png alt="Img link to Hugo website" width=22 height=22></a></li><li><a>© 2014 - 2023</a></li></ul></footer></div><script async src=https://fastly.jsdelivr.net/gh/cubarco/cubarco.github.io@gh-pages/js/async.min.e8b856a43b93a78048deb0cb92ad99794ad3acb0a2c8093599a653ece0f0a17be8763cdfc99be237c1100cf84542be5aeebc0a7cac0935c48e7b3c95b87c6f34.js onload=window.GistEmbed.init()></script><script async defer src=https://fastly.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js></script><script>window.ga_tid="UA-54867602-1",window.ga_api="https://cubar.co/ga-proxy/"</script><script src=https://fastly.jsdelivr.net/npm/cfga@1.0.3 async defer></script></body></html>