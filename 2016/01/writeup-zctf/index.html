<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><title>Writeup: ZCTF - /home/cubarco</title><meta property="og:title" content="Writeup: ZCTF - /home/cubarco"><link href=https://cubar.co/favicon.ico rel=icon type=image/x-icon><meta name=description content="Hack, CTF, Writeup, Exploitation, PWN"><link rel=stylesheet href=/css/main.min.3bcbe33ae5c46485bcebc6352fc91232f950eb735ccac53f81bd19d79251ba9c.css media=all></head><body><div class=wrapper><header class=header><nav class=nav><a href=/ class=nav-logo><img src=/images/logo-min.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/>Index</a></li><li><a href=/tags/>Tags</a></li><li><a href=/about/>About</a></li><li><a href=/links/>Links</a></li><li><a href=https://github.com/cubarco/cubarco.github.io>GitHub</a></li></ul></nav></header><main class=content role=main><article class=article><h1 class=article-title>Writeup: ZCTF</h1><span class=article-date>2016-01-24</span>
<a class=article-tag href=/tags/hack>Hack</a>
<a class=article-tag href=/tags/ctf>CTF</a>
<a class=article-tag href=/tags/writeup>Writeup</a>
<a class=article-tag href=/tags/exploitation>Exploitation</a>
<a class=article-tag href=/tags/pwn>PWN</a><div class=article-content><blockquote><p>2016 å¹´ç¬¬ä¸€ç¯‡ blog!</p></blockquote><p>è¿™æ¬¡åªåšå‡ºä¸¤é“ pwn, å¥½å¿§ä¼¤&mldr;</p><h2 id=guess>guess</h2><p>åœ¨æœ€è¿‘çš„ 32c3ctf ä¸­å‡ºç°è¿‡ä¸€é“ç±»ä¼¼çš„ readme<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. å°±æ˜¯æŠŠ<code>argv[1]</code>æ”¹æˆç›®çš„å­—ç¬¦ä¸²ä½ç½®ï¼Œå¯ä»¥åœ¨ libc æ‰“å‡ºé”™è¯¯ä¿¡æ¯çš„æ—¶å€™ï¼Œè¢«å½“ä½œæ–‡ä»¶åæ‰“å°å‡ºæ¥ã€‚</p><code class=gist data-gist-id=cubarco/cbbd4ab5462c2f0f287b><p>Gist: <a href=https://gist.github.com/cubarco/cbbd4ab5462c2f0f287b>cubarco/cbbd4ab5462c2f0f287b</a></p></code><h2 id=note1>note1</h2><p>è¿™é¢˜çš„ note æ˜¯ä»¥é“¾è¡¨å½¢å¼å‚¨å­˜çš„ï¼Œå †æº¢å‡ºï¼ˆedit å­˜åœ¨æº¢å‡ºæ¼æ´ï¼‰ä¹‹åå¯ä»¥è¦†ç›–åœ°å€æ›´æ”¹é“¾è¡¨ç»“æ„ã€‚æˆ‘çš„ exp æ€è·¯å°±æ˜¯å…ˆæŠŠä¸€ä¸ª note æŒ‡å‘<code>setvbuf()</code>çš„ got, ç„¶åç”¨ show æŠŠåœ°å€ leak å‡ºæ¥ï¼Œè¿™æ ·å¯ä»¥ offset åˆ°<code>system()</code>. ç„¶åå†å°†å¦ä¸€ä¸ª note åœ°å€æ”¹åˆ°<code>strcmp()</code>çš„ got, é€šè¿‡ edit æŠŠå†…å®¹æ”¹æˆ<code>system()</code>çš„åœ°å€ã€‚æœ€åè°ƒç”¨<code>strcmp()</code>, title å¡«<code>/bin/sh</code>å°±å¯ä»¥äº†ã€‚</p><code class=gist data-gist-id=cubarco/30a44a61252f448964c4><p>Gist: <a href=https://gist.github.com/cubarco/30a44a61252f448964c4>cubarco/30a44a61252f448964c4</a></p></code><h2 id=note2><del>note2</del></h2><p>è¿™é¢˜åœ¨èµ›æ—¶æ²¡æ‰¾åˆ°æ¼æ´ï¼Œèµ›åçœ‹äº† FlappyPig çš„ Writeup<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, åªæ˜¯ç®€å•çš„ fastbin, æ„Ÿè§‰å¥½å¯æƒœ&mldr; 360 å®‰å…¨æ’­æŠ¥ç»™çš„ä»£ç æ²¡ç¼©è¿›æ ¹æœ¬ä¸èƒ½çœ‹ï¼Œè‡ªå·±é‡æ–°å†™äº†ä¸ªã€‚</p><code class=gist data-gist-id=cubarco/9752fbbe78a071b04b37><p>Gist: <a href=https://gist.github.com/cubarco/9752fbbe78a071b04b37>cubarco/9752fbbe78a071b04b37</a></p></code><h2 id=note3><del>note3</del></h2><p>è¿™é¢˜åŒæ ·æ˜¯æ²¡æœ‰åœ¨èµ›æ—¶åšå‡ºæ¥ï¼Œä½†æ˜¯ä¸ note2 ç›¸åï¼Œè¿™é¢˜æˆ‘æ˜¯æ‰¾åˆ°äº†ä¸¤ä¸ªå¯ä»¥åˆ©ç”¨çš„æ¼æ´çš„(ä¸€ä¸ªæ˜¯ integer overflow, å¦ä¸€ä¸ªæ˜¯å¯ä»¥å¢åŠ ç¬¬å…«ä¸ª note), ä½†æ˜¯ä¸çŸ¥é“å¦‚ä½•åˆ©ç”¨ã€‚æˆ‘åœ¨æ¯”èµ›çš„æ—¶å€™ä¸€ç›´æƒ³ç€æ€ä¹ˆ fastbin, å› ä¸ºæˆ‘è§‰å¾— unlink è¿™ä¹ˆå¤è€çš„ exp è‚¯å®šå·²ç»ä¸èƒ½ç”¨äº†&mldr; æ²¡æƒ³åˆ°è¿™é¢˜çš„ç¯å¢ƒåˆšå¥½é€‚åˆ unlink, æœ‰ç‚¹å¯æƒœã€‚èµ›åçœ‹äº† FlappyPig çš„ Writeup<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, è‡ªå·±é‡æ–°å†™äº†ä¸ª exp, ä¹Ÿç®—æ˜¯å¤ä¹ ä¸€ä¸‹ unlink.</p><code class=gist data-gist-id=cubarco/ababdac123a4762c0180><p>Gist: <a href=https://gist.github.com/cubarco/ababdac123a4762c0180>cubarco/ababdac123a4762c0180</a></p></code><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://github.com/ctfs/write-ups-2015/tree/master/32c3-ctf-2015/pwn/readme-200>write-ups-2015/32c3-ctf-2015/pwn/readme-200/ @ GitHub</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=http://bobao.360.cn/ctf/detail/158.html>ZCTF Writeup @ 360 å®‰å…¨æ’­æŠ¥</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><script src=https://utteranc.es/client.js repo=cubarco/cubarco.github.io issue-term=pathname label="Comments ğŸ’¬" theme=boxy-light crossorigin=anonymous async defer></script></main><footer class=footer><ul class=footer-links><li><a href=/index.xml type=application/rss+xml target=_blank>RSS feed</a></li><li><a href=https://gohugo.io/ class=footer-links-kudos target=_blank rel="noopener norefferrer">Made with <img src=/images/hugo-logo.png alt="Img link to Hugo website" width=22 height=22></a></li><li><a>Â© 2014 - 2023</a></li></ul></footer></div><script async src=https://fastly.jsdelivr.net/gh/cubarco/cubarco.github.io@gh-pages/js/async.min.e8b856a43b93a78048deb0cb92ad99794ad3acb0a2c8093599a653ece0f0a17be8763cdfc99be237c1100cf84542be5aeebc0a7cac0935c48e7b3c95b87c6f34.js onload=window.GistEmbed.init()></script><script async defer src=https://fastly.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js></script><script>window.ga_tid="UA-54867602-1",window.ga_api="https://cubar.co/ga-proxy/"</script><script src=https://fastly.jsdelivr.net/npm/cfga@1.0.3 async defer></script></body></html>